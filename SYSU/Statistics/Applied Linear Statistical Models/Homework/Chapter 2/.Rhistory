band <- cbind(preds$fit-w*preds$se.fit,preds$fit+w*preds$se.fit)
points(sort(framex$x),sort(band[,2]),type = 'l',lty=2)
points(sort(framex$x),sort(band[,3]),type = 'l',lty=2)
preds$se.fit
preds$fit
preds$fit-w*preds$se.fit
preds$fit
preds$se.fit
preds$se.fit*w
band
framex = data.frame(x=seq(2,4,2))
preds <- predict(fit, interval = 'confidence',level=0.99,se.fit = TRUE)
plot(y ~ x, data = data1,xlim=c(2,4),ylim=c(9,preds$fit[2,3]+1))
abline(fit)
#points(seq(2,4,2),pred_a$fit[,2],col='blue',pch=20)
#points(seq(2,4,2),pred_a$fit[,3],col='blue',pch=20)
#lines(seq(2,4,2), preds$fit[ ,3], lty = 'dashed', col = 'red',type = 'b')
#lines(seq(2,4,2), preds$fit[ ,2], lty = 'dashed', col = 'red',type='b')
w <- sqrt(2*qf(0.99,2,fit$df))
band <- cbind(preds$fit-w*preds$se.fit,preds$fit+w*preds$se.fit)
points(sort(framex$x),sort(band[,2]),type = 'l',lty=2)
points(sort(data1$x),sort(band[,3]),type = 'l',lty=2)
framex = data.frame(x=seq(2,4,2))
preds <- predict(fit, interval = 'confidence',level=0.99,se.fit = TRUE)
plot(y ~ x, data = data1,xlim=c(2,4),ylim=c(9,preds$fit[2,3]+1))
abline(fit)
#points(seq(2,4,2),pred_a$fit[,2],col='blue',pch=20)
#points(seq(2,4,2),pred_a$fit[,3],col='blue',pch=20)
#lines(seq(2,4,2), preds$fit[ ,3], lty = 'dashed', col = 'red',type = 'b')
#lines(seq(2,4,2), preds$fit[ ,2], lty = 'dashed', col = 'red',type='b')
w <- sqrt(2*qf(0.99,2,fit$df))
band <- cbind(preds$fit-w*preds$se.fit,preds$fit+w*preds$se.fit)
points(sort(data1$x),sort(band[,2]),type = 'l',lty=2)
points(sort(data1$x),sort(band[,3]),type = 'l',lty=2)
framex = data.frame(x=seq(2,4,2))
preds <- predict(fit, interval = 'confidence',level=0.99,se.fit = TRUE)
plot(y ~ x, data = data1)
abline(fit)
#points(seq(2,4,2),pred_a$fit[,2],col='blue',pch=20)
#points(seq(2,4,2),pred_a$fit[,3],col='blue',pch=20)
#lines(seq(2,4,2), preds$fit[ ,3], lty = 'dashed', col = 'red',type = 'b')
#lines(seq(2,4,2), preds$fit[ ,2], lty = 'dashed', col = 'red',type='b')
w <- sqrt(2*qf(0.99,2,fit$df))
band <- cbind(preds$fit-w*preds$se.fit,preds$fit+w*preds$se.fit)
points(sort(data1$x),sort(band[,2]),type = 'l',lty=2)
points(sort(data1$x),sort(band[,3]),type = 'l',lty=2)
band
framex = data.frame(x=seq(2,4,2))
preds <- predict(fit, interval = 'confidence',level=0.99,se.fit = TRUE)
plot(y ~ x, data = data1)
abline(fit)
#points(seq(2,4,2),pred_a$fit[,2],col='blue',pch=20)
#points(seq(2,4,2),pred_a$fit[,3],col='blue',pch=20)
#lines(seq(2,4,2), preds$fit[ ,3], lty = 'dashed', col = 'red',type = 'b')
#lines(seq(2,4,2), preds$fit[ ,2], lty = 'dashed', col = 'red',type='b')
w <- sqrt(2*qf(0.99,2,fit$df))
band <- cbind(preds$fit-w*preds$se.fit,preds$fit+w*preds$se.fit)
points(sort(data1$x),sort(band[,2]),type = 'l',lty=2)
points(sort(data1$x),sort(band[,6]),type = 'l',lty=2)
framex = data.frame(x=seq(2,4,2))
preds <- predict(fit, interval = 'confidence',level=0.99,se.fit = TRUE)
plot(y ~ x, data = data1,xlim=(0,4),ylim=(8.30))
framex = data.frame(x=seq(2,4,2))
preds <- predict(fit, interval = 'confidence',level=0.99,se.fit = TRUE)
plot(y ~ x, data = data1,xlim=c(0,4),ylim=c(8,30))
abline(fit)
#points(seq(2,4,2),pred_a$fit[,2],col='blue',pch=20)
#points(seq(2,4,2),pred_a$fit[,3],col='blue',pch=20)
#lines(seq(2,4,2), preds$fit[ ,3], lty = 'dashed', col = 'red',type = 'b')
#lines(seq(2,4,2), preds$fit[ ,2], lty = 'dashed', col = 'red',type='b')
w <- sqrt(2*qf(0.99,2,fit$df))
band <- cbind(preds$fit-w*preds$se.fit,preds$fit+w*preds$se.fit)
points(sort(data1$x),sort(band[,2]),type = 'l',lty=2)
points(sort(data1$x),sort(band[,6]),type = 'l',lty=2)
framex = data.frame(x=seq(2,4,2))
preds <- predict(fit, newdata = framex, interval = 'confidence',level=0.99,se.fit = TRUE)
plot(y ~ x, data = data1,xlim=c(0,4),ylim=c(8,30))
abline(fit)
#points(seq(2,4,2),pred_a$fit[,2],col='blue',pch=20)
#points(seq(2,4,2),pred_a$fit[,3],col='blue',pch=20)
#lines(seq(2,4,2), preds$fit[ ,3], lty = 'dashed', col = 'red',type = 'b')
#lines(seq(2,4,2), preds$fit[ ,2], lty = 'dashed', col = 'red',type='b')
w <- sqrt(2*qf(0.99,2,fit$df))
band <- cbind(preds$fit-w*preds$se.fit,preds$fit+w*preds$se.fit)
points(sort(framex$x),sort(band[,2]),type = 'l',lty=2)
points(sort(framex$x),sort(band[,6]),type = 'l',lty=2)
framex = data.frame(x=seq(2,4,2))
preds <- predict(fit, newdata = framex, interval = 'confidence',level=0.99,se.fit = TRUE)
plot(y ~ x, data = data1,xlim=c(0,4),ylim=c(8,40))
abline(fit)
#points(seq(2,4,2),pred_a$fit[,2],col='blue',pch=20)
#points(seq(2,4,2),pred_a$fit[,3],col='blue',pch=20)
#lines(seq(2,4,2), preds$fit[ ,3], lty = 'dashed', col = 'red',type = 'b')
#lines(seq(2,4,2), preds$fit[ ,2], lty = 'dashed', col = 'red',type='b')
w <- sqrt(2*qf(0.99,2,fit$df))
band <- cbind(preds$fit-w*preds$se.fit,preds$fit+w*preds$se.fit)
points(sort(framex$x),sort(band[,2]),type = 'l',lty=2)
points(sort(framex$x),sort(band[,6]),type = 'l',lty=2)
framex = data.frame(x=seq(2,4,2))
preds <- predict(fit, newdata = framex, interval = 'confidence',level=0.99,se.fit = TRUE)
plot(y ~ x, data = data1,xlim=c(0,4),ylim=c(8,40))
abline(fit)
points(seq(2,4,2),pred_a$fit[,2],col='blue',pch=20)
points(seq(2,4,2),pred_a$fit[,3],col='blue',pch=20)
#lines(seq(2,4,2), preds$fit[ ,3], lty = 'dashed', col = 'red',type = 'b')
#lines(seq(2,4,2), preds$fit[ ,2], lty = 'dashed', col = 'red',type='b')
w <- sqrt(2*qf(0.99,2,fit$df))
band <- cbind(preds$fit-w*preds$se.fit,preds$fit+w*preds$se.fit)
points(sort(framex$x),sort(band[,2]),type = 'l',lty=2)
points(sort(framex$x),sort(band[,6]),type = 'l',lty=2)
framex = data.frame(x=seq(2,4,2))
preds <- predict(fit, newdata = framex, interval = 'confidence',level=0.99,se.fit = TRUE)
plot(y ~ x, data = data1,xlim=c(0,4),ylim=c(8,40))
abline(fit)
points(seq(2,4,2),pred_a$fit[,2],col='blue',pch=20)
points(seq(2,4,2),pred_a$fit[,3],col='blue',pch=20)
#lines(seq(2,4,2), preds$fit[ ,3], lty = 'dashed', col = 'red',type = 'b')
#lines(seq(2,4,2), preds$fit[ ,2], lty = 'dashed', col = 'red',type='b')
w <- sqrt(2*qf(0.99,2,fit$df))
band <- cbind(preds$fit-w*preds$se.fit,preds$fit+w*preds$se.fit)
points(sort(framex$x),sort(band[,2]),type = 'l',lty=2)
points(sort(framex$x),sort(band[,6]),type = 'l',lty=2)
print(sprintf('W=%f',w))
band[,2]
framex = data.frame(x=seq(2,4,2))
preds <- predict(fit, newdata = framex, interval = 'confidence',level=0.99,se.fit = TRUE)
plot(y ~ x, data = data1,xlim=c(0,4),ylim=c(8,40))
abline(fit)
points(seq(2,4,2),pred_a$fit[,2],col='blue',pch=20)
points(seq(2,4,2),pred_a$fit[,3],col='blue',pch=20)
#lines(seq(2,4,2), preds$fit[ ,3], lty = 'dashed', col = 'red',type = 'b')
#lines(seq(2,4,2), preds$fit[ ,2], lty = 'dashed', col = 'red',type='b')
w <- sqrt(2*qf(0.99,2,fit$df))
band <- cbind(preds$fit-w*preds$se.fit,preds$fit+w*preds$se.fit)
points(sort(framex$x),sort(band[,2]),type = 'l',lty=2)
points(sort(framex$x),sort(band[,6]),type = 'l',lty=2)
print(sprintf('W=%f',w))
print(sprintf('Confident band for X=2 is (%f,%f)',band[1,2],band[1,6]))
print(sprintf('Confident band for X=4 is (%f,%f)',band[2,2],band[2,6]))
framex = data.frame(x=seq(2,4,2))
preds <- predict(fit, newdata = framex, interval = 'confidence',level=0.99,se.fit = TRUE)
plot(y ~ x, data = data1,xlim=c(0,4),ylim=c(8,40))
abline(fit)
points(seq(2,4,2),pred_a$fit[,2],col='blue',pch=20)
points(seq(2,4,2),pred_a$fit[,3],col='blue',pch=20)
#lines(seq(2,4,2), preds$fit[ ,3], lty = 'dashed', col = 'red',type = 'b')
#lines(seq(2,4,2), preds$fit[ ,2], lty = 'dashed', col = 'red',type='b')
w <- sqrt(2*qf(0.99,2,fit$df))
band <- cbind(preds$fit-w*preds$se.fit,preds$fit+w*preds$se.fit)
points(sort(framex$x),sort(band[,1]),type = 'l',lty=2)
points(sort(framex$x),sort(band[,4]),type = 'l',lty=2)
print(sprintf('W=%f',w))
print(sprintf('Confident band for X=2 is (%f,%f)',band[1,1],band[1,4]))
print(sprintf('Confident band for X=4 is (%f,%f)',band[2,1],band[2,4]))
framex = data.frame(x=seq(2,4,2))
preds <- predict(fit, newdata = framex, interval = 'confidence',level=0.99,se.fit = TRUE)
plot(y ~ x, data = data1,xlim=c(0,4),ylim=c(8,40))
abline(fit)
points(seq(2,4,2),pred_a$fit[,2],col='blue',pch=20)
points(seq(2,4,2),pred_a$fit[,3],col='blue',pch=20)
#lines(seq(2,4,2), preds$fit[ ,3], lty = 'dashed', col = 'red',type = 'b')
#lines(seq(2,4,2), preds$fit[ ,2], lty = 'dashed', col = 'red',type='b')
w <- sqrt(2*qf(0.99,2,fit$df))
band <- cbind(preds$fit-w*preds$se.fit,preds$fit+w*preds$se.fit)
points(framex$x,band[,1],type = 'l',lty=2)
points(framex$x,band[,4],type = 'l',lty=2)
print(sprintf('W=%f',w))
print(sprintf('Confident band for X=2 is (%f,%f)',band[1,1],band[1,4]))
print(sprintf('Confident band for X=4 is (%f,%f)',band[2,1],band[2,4]))
w
band
curve(pf(x, 1, 8), 0, 5)
curve(pf(x, 2, 8), 0, 5)
plot()
plot([],[])
plot()
plot()
plot()
plot()
plot(0,1)
curve(pf(x, 1, 8), 0, 5)
curve(pf(x, 2, 8), 0, 5)
abline(pf(x, 1, 8), 0, 5)
plot(0,0)
abline(pf(x, 1, 8), 0, 5)
curve(pf(x, 2, 8), 0, 5)
curve(pf(x, 2, 8)pf(x, 1, 8), 0, 5)
curve(pf(x, 2, 8),pf(x, 1, 8), 0, 5)
set.seed(1)
x<-seq(0,5,length.out=1000)
y<-df(x,1,1,0)
plot(x,y,col="red",xlim=c(0,5),ylim=c(0,1),type='l',
xaxs="i", yaxs="i",ylab='density',xlab='',
main="The F Density Distribution")
lines(x,df(x,1,1,2),col="green")
lines(x,df(x,2,2,2),col="blue")
lines(x,df(x,2,4,4),col="orange")
legend("topright",legend=paste("df1=",c(1,1,2,2),"df2=",c(1,1,2,4)," ncp=", c(0,2,2,4)), lwd=1, col=c("red", "green","blue","orange"))
set.seed(1)
x<-seq(0,5,length.out=1000)
y<-df(x,1,1,0)
plot(x,y,col="red",xlim=c(0,5),ylim=c(0,1),type='l',
xaxs="i", yaxs="i",ylab='density',xlab='',
main="The F Density Distribution")
lines(x,df(x,2,1,0),col="blue")
legend("topright",legend=paste("df1=",c(1,1,2,2),"df2=",c(1,1,2,4)," ncp=", c(0,2,2,4)), lwd=1, col=c("red", "green","blue","orange"))
set.seed(1)
x<-seq(0,5,length.out=1000)
y<-df(x,1,1,0)
plot(x,y,col="red",xlim=c(0,5),ylim=c(0,1),type='l',
xaxs="i", yaxs="i",ylab='density',xlab='',
main="The F Cumulative Distribution Function")
lines(x,pf(x,2,1),col="blue")
legend("topright",legend=paste("df1=",c(1,1,2,2),"df2=",c(1,1,2,4)," ncp=", c(0,2,2,4)), lwd=1, col=c("red", "green","blue","orange"))
set.seed(1)
x<-seq(0,5,length.out=1000)
y<-df(x,1,1,0)
plot(x,y,col="red",xlim=c(0,5),ylim=c(0,1),type='l',
xaxs="i", yaxs="i",ylab='density',xlab='',
main="The F Cumulative Distribution Function")
lines(x,pf(x,2,1,0),col="blue")
legend("topright",legend=paste("df1=",c(1,1,2,2),"df2=",c(1,1,2,4)," ncp=", c(0,2,2,4)), lwd=1, col=c("red", "green","blue","orange"))
set.seed(1)
x<-seq(0,5,length.out=1000)
y<-pf(x,1,1,0)
plot(x,y,col="red",xlim=c(0,5),ylim=c(0,1),type='l',
xaxs="i", yaxs="i",ylab='density',xlab='',
main="The F Cumulative Distribution Function")
lines(x,pf(x,2,1,0),col="blue")
legend("topright",legend=paste("df1=",c(1,1,2,2),"df2=",c(1,1,2,4)," ncp=", c(0,2,2,4)), lwd=1, col=c("red", "green","blue","orange"))
set.seed(1)
x<-seq(0,5,length.out=1000)
y<-pf(x,1,1,0)
plot(x,y,col="red",xlim=c(0,5),ylim=c(0,1),type='l',
xaxs="i", yaxs="i",ylab='density',xlab='',
main="The F Cumulative Distribution Function")
lines(x,pf(x,2,1,0),col="blue")
legend("bottomright",legend=paste("df1=",c(1,1,2,2),"df2=",c(1,1,2,4)," ncp=", c(0,2,2,4)), lwd=1, col=c("red", "green","blue","orange"))
set.seed(1)
x<-seq(0,5,length.out=1000)
y<-pf(x,1,1,0)
plot(x,y,col="red",xlim=c(0,5),ylim=c(0,1),type='l',
xaxs="i", yaxs="i",ylab='density',xlab='',
main="The F Cumulative Distribution Function")
lines(x,pf(x,2,1,0),col="blue")
legend("bottomright",legend=paste("df1=",c(1,1),"df2=",c(2,1)," ncp=", c(0,0)), lwd=1, col=c("red", "green","blue","orange"))
set.seed(1)
x<-seq(0,5,length.out=1000)
y<-pf(x,1,1,0)
plot(x,y,col="red",xlim=c(0,5),ylim=c(0,1),type='l',
xaxs="i", yaxs="i",ylab='density',xlab='',
main="The F Cumulative Distribution Function")
lines(x,pf(x,2,1,0),col="blue")
legend("bottomright",legend=paste("df1=",c(1,1),"df2=",c(2,1)," ncp=", c(0,0)), lwd=1, col=c("red","blue))
set.seed(1)
x<-seq(0,5,length.out=1000)
y<-pf(x,1,1,0)
plot(x,y,col="red",xlim=c(0,5),ylim=c(0,1),type='l',
xaxs="i", yaxs="i",ylab='density',xlab='',
main="The F Cumulative Distribution Function")
lines(x,pf(x,2,1,0),col="blue")
legend("bottomright",legend=paste("df1=",c(1,1),"df2=",c(2,1)," ncp=", c(0,0)), lwd=1, col=c("red","blue""))
set.seed(1)
x<-seq(0,5,length.out=1000)
y<-pf(x,1,1,0)
plot(x,y,col="red",xlim=c(0,5),ylim=c(0,1),type='l',
xaxs="i", yaxs="i",ylab='density',xlab='',
main="The F Cumulative Distribution Function")
lines(x,pf(x,2,1,0),col="blue")
legend("bottomright",legend=paste("df1=",c(1,1),"df2=",c(2,1)," ncp=", c(0,0)), lwd=1, col=c("red","blue"))
set.seed(1)
x<-seq(0,5,length.out=1000)
y<-pf(x,1,1,0)
plot(x,y,col="red",xlim=c(0,5),ylim=c(0,1),type='l',
xaxs="i", yaxs="i",ylab='cumulative density',xlab='',
main="The F Cumulative Distribution Function")
lines(x,pf(x,2,1,0),col="blue")
legend("bottomright",legend=paste("df1=",c(1,1),"df2=",c(2,1)," ncp=", c(0,0)), lwd=1, col=c("red","blue"))
x <- c(1, 0, 2, 0, 3, 1, 0, 1, 2, 0)
y <- c(16, 9, 17, 12, 22, 13, 8, 15, 19, 11)
data1 <- data.frame(x,y)
fit <- lm('y~x',data1)
confint(fit)
summary(fit)
framex = data.frame(x=c(2,4))
pred_a = predict(fit,newdata = framex,se.fit = TRUE,type = "response", interval = "confidence", level=0.99)
pred_a
framex = data.frame(x=c(2))
predict(fit,newdata = framex,se.fit = TRUE,type = "response", interval = "prediction", level=0.99)
pred <- predict(fit,newdata = framex,se.fit = TRUE,type = "response", interval = "prediction", level=0.99)
s_pred = sqrt(sum(residuals(fit)^2) / df.residual(fit)+(pred$se.fit)^2)
print(sprintf('s{pred}:%f',s_pred))
framex = data.frame(x=c(2))
predict(fit,newdata = framex,se.fit = TRUE,type = "terms", interval = "prediction", level=0.99)
pred <- predict(fit,newdata = framex,se.fit = TRUE,type = "response", interval = "prediction", level=0.99)
s_predmean = sqrt(sum(residuals(fit)^2) / df.residual(fit)/3+(pred$se.fit)^2)
print(sprintf('s{predmean}:%f',s_pred))
print(sprintf('the prediction interval of Yh(new) is (%f,%f)',pred$fit[1]-qt(.995, df=c(8))*s_predmean,pred$fit[1]+qt(.995, df=c(8))*s_predmean))
print(sprintf('the total number of broken ampules is (%f,%f)',(pred$fit[1]-qt(.995, df=c(8))*s_predmean)*3,(pred$fit[1]+qt(.995, df=c(8))*s_predmean)*3))
framex = data.frame(x=seq(2,4,2))
preds <- predict(fit, newdata = framex, interval = 'confidence',level=0.99,se.fit = TRUE)
plot(y ~ x, data = data1,xlim=c(0,4),ylim=c(8,40))
abline(fit)
points(seq(2,4,2),pred_a$fit[,2],col='blue',pch=20)
points(seq(2,4,2),pred_a$fit[,3],col='blue',pch=20)
#lines(seq(2,4,2), preds$fit[ ,3], lty = 'dashed', col = 'red',type = 'b')
#lines(seq(2,4,2), preds$fit[ ,2], lty = 'dashed', col = 'red',type='b')
w <- sqrt(2*qf(0.99,2,fit$df))
band <- cbind(preds$fit-w*preds$se.fit,preds$fit+w*preds$se.fit)
points(framex$x,band[,1],type = 'l',lty=2)
points(framex$x,band[,4],type = 'l',lty=2)
print(sprintf('W=%f',w))
print(sprintf('Confident band for X=2 is (%f,%f)',band[1,1],band[1,4]))
print(sprintf('Confident band for X=4 is (%f,%f)',band[2,1],band[2,4]))
set.seed(1)
x<-seq(0,5,length.out=1000)
y<-pf(x,1,1,0)
plot(x,y,col="red",xlim=c(0,5),ylim=c(0,1),type='l',
xaxs="i", yaxs="i",ylab='cumulative density',xlab='',
main="The F Cumulative Distribution Function")
lines(x,pf(x,2,1,0),col="blue")
legend("bottomright",legend=paste("df1=",c(1,1),"df2=",c(2,1)," ncp=", c(0,0)), lwd=1, col=c("red","blue"))
aov(fit)
summary(aov(fit))
SXX <- sum((data1$x - mean(data1$x))^2)
SXX <- sum((data1$x - mean(data1$x))^2)
SXX
SXX <- sum((data1$x - mean(data1$x))^2)
(length(x)-1)*var(x)
SXX <- sum((data1$x - mean(data1$x))^2)
(length(data1$x)-1)*var(data1$x)
SXX <- sum((data1$x - mean(data1$x))^2)
SXX <- sum((data1$x - mean(data1$x))^2)
MSE <- mean(fit$residuals^2)
SXX <- sum((data1$x - mean(data1$x))^2)
MSE <- mean(fit$residuals^2)
MSE
SXX <- sum((data1$x - mean(data1$x))^2)
MSE <- mean(fit$residuals^2)
MSE / SXX
SXX <- sum((data1$x - mean(data1$x))^2)
MSE <- mean(fit$residuals^2)
MSE / SXX
SXX <- sum((data1$x - mean(data1$x))^2)
MSE <- mean(fit$residuals^2)
sqrt(MSE / SXX)
SXX <- sum((data1$x - mean(data1$x))^2)
MSE <- fit$residuals^2/fit$df.residual
sqrt(MSE / SXX)
SXX <- sum((data1$x - mean(data1$x))^2)
MSE <- fit$residuals^2/fit$df
sqrt(MSE / SXX)
SXX <- sum((data1$x - mean(data1$x))^2)
MSE <- fit$residuals^2/fit$df
sqrt(MSE / SXX)
SXX <- sum((data1$x - mean(data1$x))^2)
MSE <- fit$residuals^2/fit$df
sqrt(MSE / SXX)
fit$df
SXX <- sum((data1$x - mean(data1$x))^2)
MSE <- sum(fit$residuals^2)/fit$df
sqrt(MSE / SXX)
SXX <- sum((data1$x - mean(data1$x))^2)
MSE <- sum(fit$residuals^2)/fit$df
t <- sqrt(MSE / SXX)
fit$coefficients
SXX <- sum((data1$x - mean(data1$x))^2)
MSE <- sum(fit$residuals^2)/fit$df
t <- sqrt(MSE / SXX)
fit$coefficients[2]
SXX <- sum((data1$x - mean(data1$x))^2)
MSE <- sum(fit$residuals^2)/fit$df
t <- fit$coefficients[2] / sqrt(MSE / SXX)
SXX <- sum((data1$x - mean(data1$x))^2)
MSE <- sum(fit$residuals^2)/fit$df
t <- fit$coefficients[2] / sqrt(MSE / SXX)
t
SXX <- sum((data1$x - mean(data1$x))^2)
MSE <- sum(fit$residuals^2)/fit$df
t <- fit$coefficients[2] / sqrt(MSE / SXX)
print(sprinf('t value is %f',t))
SXX <- sum((data1$x - mean(data1$x))^2)
MSE <- sum(fit$residuals^2)/fit$df
t <- fit$coefficients[2] / sqrt(MSE / SXX)
print(sprintf('t value is %f',t))
print(sprintf('square t value is %f=F',t^2))
cor(data1$x,data1$y)
cor(data1$x,data1$y)
cor(data1$x,data1$y)^2
print(sprintf('r: %f',cor(data1$x,data1$y)))
print(sprintf('R: %f',cor(data1$x,data1$y)^2))
print(sprintf('r: %f',cor(data1$x,data1$y)))
print(sprintf('R^2: %f',cor(data1$x,data1$y)^2))
print(sprintf('r:   %f',cor(data1$x,data1$y)))
print(sprintf('R^2: %f',cor(data1$x,data1$y)^2))
print(sprintf('r:   %f',cor(data1$x,data1$y)))
print(sprintf('R^2: %f',cor(data1$x,data1$y)^2))
print(sprintf('The proportion of variation in Y accounted for by introducting X into regression model is %f',cor(data1$x,data1$y)^2))
knit_with_parameters('~/Documents/study/应用回归分析/Homework/2/Homework Chapter 2.Rmd')
read.table(“CH02PR42.txt”,head=FALSE)
data2 <- read.table("CH02PR42.txt",head=FALSE)
data2 <- read.table("CH02PR42.txt",head=FALSE)
data2
data2 <- read.table("CH02PR42.txt",head=FALSE,col.names = c('Y1','Y2'))
data2
data2 <- read.table("CH02PR42.txt",head=FALSE,col.names = c('Y1','Y2'))
plot(data2)
data2 <- read.table("CH02PR42.txt",head=FALSE,col.names = c('Y1','Y2'))
plot(data2)
points(min(data2$Y1),data2$Y2)
data2 <- read.table("CH02PR42.txt",head=FALSE,col.names = c('Y1','Y2'))
plot(data2)
points(rep(min(data2$Y1),len(data2$Y1)),data2$Y2)
data2 <- read.table("CH02PR42.txt",head=FALSE,col.names = c('Y1','Y2'))
plot(data2)
points(rep(min(data2$Y1),length(data2$Y1)),data2$Y2)
data2 <- read.table("CH02PR42.txt",head=FALSE,col.names = c('Y1','Y2'))
plot(data2)
points(rep(min(data2$Y1),length(data2$Y1)),data2$Y2,col='blue')
data2 <- read.table("CH02PR42.txt",head=FALSE,col.names = c('Y1','Y2'))
plot(data2)
points(rep(min(data2$Y1),length(data2$Y1)),data2$Y2,col='blue')
points(data2$Y1,rep(min(data2$Y2),length(data2$Y2)),col='red')
data2 <- read.table("CH02PR42.txt",head=FALSE,col.names = c('Y1','Y2'))
plot(data2)
points(rep(min(data2$Y1),length(data2$Y1)),data2$Y2,col='blue',pch=0)
points(data2$Y1,rep(min(data2$Y2),length(data2$Y2)),col='red',pch=0)
data2 <- read.table("CH02PR42.txt",head=FALSE,col.names = c('Y1','Y2'))
plot(data2)
points(rep(min(data2$Y1),length(data2$Y1)),data2$Y2,col='blue',pch=46)
points(data2$Y1,rep(min(data2$Y2),length(data2$Y2)),col='red',pch=0)
data2 <- read.table("CH02PR42.txt",head=FALSE,col.names = c('Y1','Y2'))
plot(data2)
points(rep(min(data2$Y1),length(data2$Y1)),data2$Y2,col='blue',pch=46)
points(data2$Y1,rep(min(data2$Y2),length(data2$Y2)),col='red',pch=46)
cor(data2)
print(sprintf('r12 is %f',cor(data2)))
print(sprintf('r12 is %f',cor(data2)[1,2]))
cor(data2)[1,2]
summary(cor(data2))
cor.test(data2)
cor.test(data2$Y1,data2$Y2)
cor.test(data2$Y1,data2$Y2,conf.level=0.01)
cor(data2$Y1,data2$Y2,method = "pearson")
cor.test(data2$Y1,data2$Y2,method = "pearson")
cor.test(data2$Y1,data2$Y2,method = "spearmen")
cor.test(data2$Y1,data2$Y2,method = "spearman")
cor(data2$Y1,data2$Y2,method = "spearman")
cor(data2$Y1,data2$Y2,method = "spearman")
cor.test(data2$Y1,data2$Y2,method = "spearman")
cor.test(data2$Y1,data2$Y2,alternative = "two.sided",method = "spearman")
cor.test(data2$Y1,data2$Y2,alternative = "two.sided",method = "spearman",conf.level = 0.01)
cor.test(data2$Y1,data2$Y2,alternative = "two.sided",method = "spearman",conf.level = 0.99)
cor(data2$Y1,data2$Y2,method = "spearman")
cor(data2$Y1,data2$Y2,method = "spearman")
qt(.995, df=length(data2$Y1)-2)
cor(data2$Y1,data2$Y2,method = "spearman")
qt(.995, df=length(data2$Y1)-2)
rs <- cor(data2$Y1,data2$Y2,method = "spearman")
t2 = rs/sqrt((1-rs^2)/(length(data2$Y1)-2))
qt(.995, df=length(data2$Y1)-2)
rs <- cor(data2$Y1,data2$Y2,method = "spearman")
t2 = rs/sqrt((1-rs^2)/(length(data2$Y1)-2))
t2
qt(.995, df=length(data2$Y1)-2)
print(-pnorm(0.975)-2/0.5)
print(pnorm(-qnorm(0.975)-2/0.5))
print(1-pnorm(qnorm(0.975)-2/0.5)+pnorm(-qnorm(0.975)-2/0.5))
print(1-pt((qt(0.975,6)/2-2)/0.4690,6)+pt((-qt(0.975,6)/2-2)/0.4690,6))
print(1-pt((qt(0.975,8)/2-2)/0.4690,8)+pt((-qt(0.975,8)/2-2)/0.4690,8))
delta = abs(2-0)/0.5
0.4690
print(1-pt(qt(0.975,8)-2/0.4690,8)+pt(-qt(0.975,8)-2/0.4690,8))
print(1-pt(qt(0.975,8)-delta/0.4690,8)+pt(-qt(0.975,8)-delta/0.4690,8))
delta
print(1-pt(qt(0.975,8)-2/0.4690-delta,8)+pt(-qt(0.975,8)-2/0.4690-delta,8))
print(1-pt(qt(0.975-delta,8)-2/0.4690,8)+pt(-qt(0.975-delta,8)-2/0.4690,8))
print(1-pt(qt(0.975,8)+delta-2/0.4690,8)+pt(-qt(0.975,8)+delta-2/0.4690,8))
print(1-pt(qt(0.975,8)-delta-2/0.4690,8)+pt(-qt(0.975,8)-delta-2/0.4690,8))
print(1-pt(qt(0.975,8)-2/0.4690,8,delta)+pt(-qt(0.975,8)-2/0.4690,8,delta))
print(1-pt(qt(0.975,8,delta)-2/0.4690,8,delta)+pt(-qt(0.975,8,delta)-2/0.4690,8,delta))
print(1-pt(qt(0.975,8,delta)-2/0.4690,8)+pt(-qt(0.975,8,delta)-2/0.4690,8))
print(1-pt(qt(0.975,8,delta)-2/0.4690,8,delta)+pt(-qt(0.975,8,delta)-2/0.4690,8,delta))
print(1-pt(qt(0.975,8)-2/0.4690,8,delta)+pt(-qt(0.975,8)-2/0.4690,8,delta))
print(1-pt(qt(0.975,8,delta)-2/0.4690,8)+pt(-qt(0.975,8,delta)-2/0.4690,8))
print(1-pt(qt(0.975,8,delta)-2/0.4690,8)+pt(-qt(0.975,8,delta)-2/0.4690,8))
print(1-pt(qt(0.975,8,delta)-2/0.4690,8,delta)+pt(qt(0.025,8,delta)-2/0.4690,8,delta))
print(1-pt(qt(0.975,8,delta)-2/0.4690,8)+pt(qt(0.025,8,delta)-2/0.4690,8))
print(1-pt(qt(0.975,8,delta)-2/0.4690,8)+pt(-qt(0.975,8,delta)-2/0.4690,8))
print(1-pt(qt(0.975,8,-delta)-2/0.4690,8)+pt(-qt(0.975,8,-delta)-2/0.4690,8))
print(1-pt(qt(0.975,8)-2/0.4690,8,-delta)+pt(-qt(0.975,8)-2/0.4690,8,-delta))
print(1-pt(qt(0.975,8,delta)-2/0.4690,8)+pt(-qt(0.975,8,delta)-2/0.4690,8))
print(1-pt(qt(0.975,8,delta),8)+pt(-qt(0.975,8,delta).4690,8))
print(1-pt(qt(0.975,8,delta),8)+pt(-qt(0.975,8,delta),8))
print(1-pt(qt(0.975,8),8,delta)+pt(-qt(0.975,8),8,delta))
print(1-pt(qt(0.975,8),8,delta0)+pt(-qt(0.975,8),8,delta0))
delta0 = abs(11-9)/0.75
print(sprintf('delta0:%f',delta0))
print(sprintf('s{b0}:%f',0.6633))
print(1-pt(qt(0.975,8),8,delta0)+pt(-qt(0.975,8),8,delta0))
print(1-pt(qt(0.975,8),8,delta0))
delta0 = abs(11-9)/0.75
print(sprintf('delta0:%f',delta0))
print(sprintf('s{b0}:%f',0.6633))
print(1-pt(qt(0.975,8),8,delta0))
print(1-pt(qt(0.95,8),8,delta0))
1/2*ln(1+0.3/0.7)
1/2*log(1+0.3/0.7)
install.packages("amsmath")
install.packages("amsmath")
knit_with_parameters('~/Documents/study/应用回归分析/Homework/2/Homework Chapter 2.Rmd')
unlink('Homework Chapter 2_cache', recursive = TRUE)
